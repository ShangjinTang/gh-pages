(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7852],{22267:(e,n,s)=>{"use strict";s.r(n),s.d(n,{Predict:()=>h,assets:()=>u,contentTitle:()=>d,default:()=>f,frontMatter:()=>l,metadata:()=>c,toc:()=>p});var t=s(85893),o=s(11151),r=s(51007),i=s(85347),a=s(67294);const l={authors:["sol"],slug:"features/support-tensorflow-js",title:"Support TensorFlow.js",tags:["mdx","tensorflow","tensorflow-js"]},d="Support TensorFlow.js",c={permalink:"/site/zh-CN/blog/features/support-tensorflow-js",source:"@site/blog/2023-11-28-support-tensorflow-js/index.mdx",title:"Support TensorFlow.js",description:"We even support TensorFlow.js in MDX with React.",date:"2023-11-28T00:00:00.000Z",formattedDate:"2023\u5e7411\u670828\u65e5",tags:[{label:"mdx",permalink:"/site/zh-CN/blog/tags/mdx"},{label:"tensorflow",permalink:"/site/zh-CN/blog/tags/tensorflow"},{label:"tensorflow-js",permalink:"/site/zh-CN/blog/tags/tensorflow-js"}],hasTruncateMarker:!0,authors:[{name:"Shangjin Tang",title:"Full Stack Developer",imageURL:"https://www.szdev.com/blog/images/avatar.jpg",key:"sol"}],frontMatter:{authors:["sol"],slug:"features/support-tensorflow-js",title:"Support TensorFlow.js",tags:["mdx","tensorflow","tensorflow-js"]},unlisted:!1,prevItem:{title:"Interactive Map with Leaflet",permalink:"/site/zh-CN/blog/features/interactive-map-with-leaflet"},nextItem:{title:"Support Mermaid Diagrams",permalink:"/site/zh-CN/blog/features/support-mermaid-diagrams"}},u={authorsImageUrls:[void 0]},p=[{value:"React Function Definition",id:"react-function-definition",level:2},{value:"React Function Usage",id:"react-function-usage",level:2}],h=({xsData:e,ysData:n,input:s})=>{const[t,o]=(0,a.useState)("Loading...");return(0,a.useEffect)((()=>{(async()=>{const t=i.Pel();t.add(i.ugM.dense({units:1,inputShape:[1]})),t.compile({loss:"meanSquaredError",optimizer:"sgd"});const r=i.odF(e,[e.length,1]),a=i.odF(n,[n.length,1]);await t.fit(r,a,{epochs:10,callbacks:{onEpochEnd:(e,n)=>console.log(`Epoch ${e}: loss = ${n.loss}`)}});const l=t.predict(i.odF([s],[1,1])).dataSync()[0];o(l)})()}),[]),void 0!==t?t:"Loading..."};function g(e){const n={admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components},{Highlight:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Highlight",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["We even support ",(0,t.jsx)(n.strong,{children:"TensorFlow.js"})," in ",(0,t.jsx)(n.strong,{children:"MDX"})," with ",(0,t.jsx)(n.strong,{children:"React"}),"."]}),"\n","\n","\n","\n","\n",(0,t.jsx)(n.p,{children:"Training Data:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"xs = [1, 3, 6, 10, 15]"}),"\n",(0,t.jsx)(n.li,{children:"ys = [1, 5, 11, 19, 29]"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Inference result for data 8:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(s,{color:"#1877F2",children:[" ",(0,t.jsx)(h,{xsData:[1,3,6,10,15],ysData:[1,5,11,19,29],input:8})," "]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Use inspection tool to see logs of training, such as ",(0,t.jsx)(n.code,{children:"F12"})," in Chrome."]}),"\n",(0,t.jsx)(n.li,{children:"Refresh the page to see different inference result."}),"\n"]})}),"\n",(0,t.jsx)(n.h2,{id:"react-function-definition",children:"React Function Definition"}),"\n",(0,t.jsx)(r.Z,{children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsx",children:"import * as tf from '@tensorflow/tfjs';\nimport {useEffect, useState} from 'react';\n\nexport const Predict = ({xsData, ysData, input}) => {\n  const [prediction, setPrediction] = useState('Loading...');\n  useEffect(() => {\n    const runPrediction = async () => {\n      const model = tf.sequential();\n      model.add(tf.layers.dense({units: 1, inputShape: [1]}));\n      model.compile({loss: 'meanSquaredError', optimizer: 'sgd'});\n      // Reshape data to 2D for training.\n      const xs = tf.tensor2d(xsData, [xsData.length, 1]);\n      const ys = tf.tensor2d(ysData, [ysData.length, 1]);\n      // Train the model using the data.\n      await model.fit(xs, ys, {\n        epochs: 10,\n        callbacks: {\n          onEpochEnd: (epoch, log) => console.log(`Epoch ${epoch}: loss = ${log.loss}`),\n        },\n      });\n      // Use the model to do inference on the provided input.\n      const result = model.predict(tf.tensor2d([input], [1, 1]));\n      const predictionValue = result.dataSync()[0];\n      setPrediction(predictionValue);\n    };\n    runPrediction();\n  }, []); // passing an empty array as the dependency to only trigger once in lifecycle\n  return prediction !== undefined ? prediction : 'Loading...';\n};\n"})})}),"\n",(0,t.jsx)(n.h2,{id:"react-function-usage",children:"React Function Usage"}),"\n",(0,t.jsx)(r.Z,{children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsx",children:"<Predict xsData={[1, 3, 6, 10, 15]} ysData={[1, 5, 11, 19, 29]} input={8}></Predict>\n"})})})]})}function f(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(g,{...e})}):g(e)}},51007:(e,n,s)=>{"use strict";s.d(n,{Z:()=>i});s(67294);var t=s(86010);const o={browserWindow:"browserWindow_my1Q",browserWindowHeader:"browserWindowHeader_jXSR",row:"row_KZDM",buttons:"buttons_uHc7",right:"right_oyze",browserWindowAddressBar:"browserWindowAddressBar_Pd8y",dot:"dot_giz1",browserWindowMenuIcon:"browserWindowMenuIcon_Vhuh",bar:"bar_rrRL",browserWindowBody:"browserWindowBody_Idgs"};var r=s(85893);function i(e){let{children:n,minHeight:s,url:i="http://localhost:3000",style:a,bodyStyle:l}=e;return(0,r.jsxs)("div",{className:o.browserWindow,style:{...a,minHeight:s},children:[(0,r.jsxs)("div",{className:o.browserWindowHeader,children:[(0,r.jsxs)("div",{className:o.buttons,children:[(0,r.jsx)("span",{className:o.dot,style:{background:"#f25f58"}}),(0,r.jsx)("span",{className:o.dot,style:{background:"#fbbe3c"}}),(0,r.jsx)("span",{className:o.dot,style:{background:"#58cb42"}})]}),(0,r.jsx)("div",{className:(0,t.Z)(o.browserWindowAddressBar,"text--truncate"),children:i}),(0,r.jsx)("div",{className:o.browserWindowMenuIcon,children:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:o.bar}),(0,r.jsx)("span",{className:o.bar}),(0,r.jsx)("span",{className:o.bar})]})})]}),(0,r.jsx)("div",{className:o.browserWindowBody,style:l,children:n})]})}},75410:()=>{},48628:()=>{},31601:()=>{},67792:()=>{},34977:()=>{},75042:()=>{}}]);