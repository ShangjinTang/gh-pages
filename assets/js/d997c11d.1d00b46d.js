"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[3216],{92565:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var t=a(85893),r=a(11151);const i={},o="ROC and AUC",s={id:"machine-learning/evaluation-metrics/roc-and-auc",title:"ROC and AUC",description:"In signal detection theory, the Receiver Operating Characteristic (ROC) curve is a coordinate graphical analysis tool. The classification model can be evaluated by calculating the Area Under Curve (AUC) of the ROC. ROC analyzes a binary classification model.",source:"@site/docs/machine-learning/evaluation-metrics/roc-and-auc.md",sourceDirName:"machine-learning/evaluation-metrics",slug:"/machine-learning/evaluation-metrics/roc-and-auc",permalink:"/site/docs/machine-learning/evaluation-metrics/roc-and-auc",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"machinelearningSidebar",previous:{title:"Confusion Matrix",permalink:"/site/docs/machine-learning/evaluation-metrics/confusion-matrix"},next:{title:"Feature Importance",permalink:"/site/docs/machine-learning/feature-selection/feature-importance"}},c={},l=[{value:"Data import and preprocessing",id:"data-loading-and-preprocessing",level:2},{value:"Scikit-learn Implementation of ROC",id:"roc-plotting-in-sklearn",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"roc-and-auc",children:"ROC and AUC"}),"\n",(0,t.jsx)(n.p,{children:"In signal detection theory, the Receiver Operating Characteristic (ROC) curve is a coordinate graphical analysis tool. The classification model can be evaluated by calculating the Area Under Curve (AUC) of the ROC. ROC analyzes a binary classification model."}),"\n",(0,t.jsx)(n.p,{children:"The ROC curve selects a model by plotting TPR (True Positive Rate) and FPR (False Positive Rate) using different classification thresholds. It shows the performance of the model under different classification thresholds. The diagonal line of the ROC curve can be interpreted as random guessing (such as tossing a coin, the prediction probability of heads and tails is 50%), and the classification model falling above the diagonal is better than random guessing, and the classification model falling below the diagonal is better than random guessing. Classification models are worse than random guessing."}),"\n",(0,t.jsx)(n.p,{children:"AUC is the area under the ROC curve, that is, the area between the ROC curve and the horizontal axis. AUC values range from 0 to 1, where 0.5 means that the model's predictive performance is equal to random guessing, and 1 means a perfect classifier. The closer the AUC value is to 1, the better the performance of the model."}),"\n",(0,t.jsx)(n.p,{children:"Below we will implement the ROC curve plotting of a classifier that uses only two features from the wdbc dataset to predict whether a tumor is benign or malignant."}),"\n",(0,t.jsx)(n.h2,{id:"data-loading-and-preprocessing",children:"Data import and preprocessing"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import StratifiedKFold\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.pipeline import make_pipeline\n\ndf = pd.read_csv(\n    "https://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/wdbc.data",\n    header=None,\n)\nX = df.loc[:, 2:].values\ny = df.loc[:, 1].values\nle = LabelEncoder()\ny = le.fit_transform(y)\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.20, stratify=y, random_state=1\n)\n'})}),"\n",(0,t.jsx)(n.h2,{id:"roc-plotting-in-sklearn",children:"Scikit-learn Implementation of ROC"}),"\n",(0,t.jsxs)(n.p,{children:["Use the logistic regression pipeline and use ",(0,t.jsx)(n.code,{children:"StratifiedKFold"})," with a fold number of 3, as shown in the following code:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'from sklearn.metrics import roc_curve, auc\nfrom scipy import interp\n\npipe_lr = make_pipeline(\n    StandardScaler(),\n    PCA(n_components=2),\n    LogisticRegression(penalty="l2", random_state=1, C=100.0),\n)\n\nX_train2 = X_train[:, [4, 14]]\ncv = list(StratifiedKFold(n_splits=3, random_state=1).split(X_train, y_train))\n\nfig = plt.figure(figsize=(7, 5))\n\nmean_tpr = 0.0\nmean_fpr = np.linspace(0, 1, 100)\nall_tpr = []\n\nfor i, (train, test) in enumerate(cv):\n    probas = pipe_lr.fit(X_train2[train], y_train[train]).predict_proba(X_train2[test])\n    fpr, tpr, thresholds = roc_curve(y_train[test], probas[:, 1], pos_label=1)\n    mean_tpr += interp(mean_fpr, fpr, tpr)\n    mean_tpr[0] = 0.0\n    roc_auc = auc(fpr, tpr)\n    plt.plot(fpr, tpr, label="ROC fold {} (area = {:.2f}".format(i + 1, roc_auc))\n\nplt.plot([0, 1], [0, 1], linestyle="--", color=(0.6, 0.6, 0.6), label="random guessing")\n\nmean_tpr /= len(cv)\nmean_tpr[-1] = 1.0\nmean_auc = auc(mean_fpr, mean_tpr)\nplt.plot(\n    mean_fpr, mean_tpr, "k--", label="mean ROC (area = {:.2f}".format(mean_auc), lw=2\n)\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The code above interpolates the average ROC curve of three folds via the ",(0,t.jsx)(n.code,{children:"interp"})," function imported from SciPy and calculates the area under the curve via the ",(0,t.jsx)(n.code,{children:"auc"})," function."]}),"\n",(0,t.jsx)(n.p,{children:"The ROC curve plotted three times shows that there is some degree of variation between different folds, and the average ROC AUC (0.76) falls between a perfect prediction (1.0) and a random guess (0.5):"}),"\n",(0,t.jsx)(n.img,{src:"https://image.szdev.com/images/2018/12/03/book-py_ml_2nd-06_10.png",width:"600"}),"\n",(0,t.jsxs)(n.p,{children:["If you only need the AUC score of ROC, you can also directly import the ",(0,t.jsx)(n.code,{children:"sklearn.metrics.roc_auc_score"})," function. The AUC score of ROC can evaluate a binary classification model with an uneven number of samples."]})]})}function p(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},11151:(e,n,a)=>{a.d(n,{Z:()=>s,a:()=>o});var t=a(67294);const r={},i=t.createContext(r);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);